define(["jquery","ajaxConfig"],function(e,t){function h(){e(i).not(".button-subscribe-and-policy").on("click",d),e(s).on("click",v)}function p(e){var t=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return t.test(e)}function d(t){return t.preventDefault(),c.removeClass("error"),e(o).text(""),c.val()?p(c.val())?(c.trigger("blur"),e(n).addClass(f),setTimeout(function(){var t=e.ajax({url:r,type:"POST",data:jQuery.param({email:c.val(),CSRFToken:hybris.CSRFToken}),dataType:"json"});t.done(function(){e(u).addClass(l)})},600),!0):(c.trigger("focus"),c.addClass("error"),e(o).text("Field is not a valid email"),!1):(c.trigger("focus"),c.addClass("error"),e(o).text("Field required."),!1)}function v(t){t.preventDefault(),c.removeClass("error"),e(o).text("");var i={},h=!1;return e("#order-confirmation-subscribe input:checked")&&e("input:checked",n).each(function(){e(this).hasClass("already-accepted")||(h=!0),i[e(this).attr("name")]="on"}),c.is(":visible")&&c.val()!==""&&!p(c.val())?(c.trigger("focus"),c.addClass("error"),e(o).text(e(s).data("invalid-email")),!1):e("#order-confirmation-subscribe input:checked").length>0&&!h?(e(o).text(e(s).data("invalid-option")),!1):(i.email=c.val(),i.CSRFToken=hybris.CSRFToken,c.trigger("blur"),e(n).addClass(f),setTimeout(function(){var t=e.ajax({url:r,type:"POST",data:jQuery.param(i),dataType:"json"});t.done(function(){c.val()!==undefined&&c.val()!==""?e(u).addClass(l):e(a).addClass(l)})},600),!0)}var n=".subscribe form",r=t.getRemoteService("SIGN-UP-UPDATES"),i=".button-subscribe",s=".button-subscribe-and-policy",o=".error-message",u=".gucci-subscribe",a=".gucci-privacy",f="_hide",l="_show",c=e("#subscribe-newsletter-email",n);return{load:function(){h()}}});
