define(["jquery","breakpoints","handlebars","imageLoader","savedItems"],function(e,t,n,r,i){function s(t){this.$context=t;if(this.$context.hasClass("js_capsule"))return;this.$context.addClass("js_capsule"),this.templateSelector=this.$context.find(".looks-grid").data("load-more-template"),this.templateSource=e(this.templateSelector).html(),this.template=n.compile(this.templateSource),this.targetSelector=this.$context.find(".looks-grid").data("load-more-target"),this.$target=e(this.targetSelector,this.$context),this.$buttonWrapper=e(".capsule-filters-list",this.$context),this.$button=e(".capsule-looks-grid-filter-link",this.$buttonWrapper),this.bindEvents()}function o(){e('[data-module="capsuleLooksGrid"]').each(function(){new s(e(this))})}return s.prototype.updateArticles=function(){this.$articleWrapper=e("#looks-grid-items-container",this.$context),this.$article=e(".looks-grid-item",this.$articleWrapper)},s.prototype.updateArticlesAndFixBorders=function(){this.updateArticles(),this.fixBorders(),i.fillSavedItems()},s.prototype.loadArticles=function(){var e="",t=this.template;GUCCI.capsuleLooks.items.forEach(function(n){e+=t(n)}),this.$target.append(e),r.loadImage(this.$target),this.updateArticlesAndFixBorders()},s.prototype.bindEvents=function(){this.loadArticles(),this.$button.on("click",e.proxy(this.filterHandler,this)),t.change(e.proxy(this.fixBorders,this)),e('[data-module="loadMore"]',this.$context).on("load-more-success",e.proxy(this.updateArticlesAndFixBorders,this))},s.prototype.filterHandler=function(t){var n=e(t.currentTarget),r=n.data("filter"),i=r=="women"?"woman":r=="men"?"man":"all";this.updateArticles(),this.$button.removeClass("selected"),n.addClass("selected"),this.filterSearch(i),n.closest(".capsule-looks-grid-filters").next().find(".looks-ajax-loader-link").attr("data-on-success",i),t.preventDefault()},s.prototype.fixBorders=function(){if(this.$article!==undefined){var e=t.is("standard")?5:t.is("medium")?3:2;this.$article.addClass("border-right").removeClass("no-border-right").not("._hide").filter(function(t){return(t+1)%e===0}).toggleClass("border-right no-border-right")}},s.prototype.filterSearch=function(e){e=="all"?this.$article.removeClass("_hide"):this.$article.addClass("_hide").filter("."+e).removeClass("_hide"),this.fixBorders()},{load:function(){o()}}});
