define(["jquery","ajaxConfig"],function(e,t){function m(e,t,r){var i=r.closest(o);i.addClass(n),g()}function g(){var t=e(r+":not(."+n+")").length;f.html(t)}function y(){u.on("click",function(t){var n=e(this),r=n.data("success");e(document).on("shopping-bag.add",function(){if(n.hasClass(i)){t.stopPropagation(),t.preventDefault();return}n.addClass(i).html(r)})}),a.on("click",function(){var t=e(this),n=t.data("success");e(document).on("shopping-bag.add",function(){t.closest(".tooltip-add-to-bag").removeClass("_active").prev().addClass(i).html(n),e("a."+i).removeClass("tooltip-open")})}),e(".saved-item-content-link-add-backorder").on("click",function(){l=e(this)}),e(".saved-items-backorder-overlay-content .overlay-close-button-first").on("click",function(){l=undefined}),e(".add-to-bag-size-guide .size-guide-link",s).each(function(){var t=e(this).attr("href");t===undefined||t===""?e(this).hide():e(t).length===0&&e(this).hide()})}function b(){}function w(){e("input#hasSavedItem").val()&&e.ajax({url:v,type:"GET",dataType:"json"}).done(function(t){e.each(t.data,function(t,n){e("[data-save-item*="+n.id+"]").addClass(r)}),e(".favorite").removeClass("overlay-open").attr("href","#")}).fail(function(){})}function E(){e(window).on("saved-item.remove",e.proxy(m)),e(document).on("shopping-bag.add",function(){typeof l!="undefined"&&l!==null&&l.length&&(l.addClass(i).removeClass("overlay-open").text(l.data("success")),l=null)}),e(".open-fis").on("click",function(){var t=e(".find-in-store-product-selected-wrapper",c),n=e("#fis-element-selected-"+e(this).data("item-id"));e(".fis-elements-selected-container").append(e(".fis-element-selected-item",t)),e(this).data("no-size")?e(".fis-elements-selected-container .product-detail-size-select").hide():e(".fis-elements-selected-container .product-detail-size-select").show(),t.empty().append(n),c.data("item-id",e(this).data("item-id")),c.data("style-id",e(this).data("style-id")),d.hide(),p.show(),h.val("")}),e(".saved-item-content-link-add-backorder").on("click",function(){e("#saved-items-backorder-overlay input[name=size]").val(e(this).data("size-code")),e("#saved-items-backorder-overlay .title-bottom-line-diamond").text(e(this).data("name")),e("#saved-items-backorder-overlay .saved-items-backorder-overlay-message").text(e(this).data("delivery-msg"))}),e("html").on("click","a."+i,function(e){e.preventDefault()})}var n="saved-item-removed",r=".saved-item",i="saved-item-content-link-added",s=e(".saved-items-wrapper"),o=e(r,s),u=e(".saved-item-content-link-add:not(.saved-item-content-link-add-backorder)",s),a=e("button.add-to-bag-button",s),f=e(".saved-items-header-ammount",s),l,c=e("#find-in-store-overlay"),h=e(".stores-map-index-search-input",c),p=e(".stores-map-index",c),d=e(".stores-map-results",c);r="_active";var v=t.getRemoteService("SAVED-ITEMS-GET-ENDPOINT");return{load:function(){y(),b(),E()},fillSavedItems:w}});
