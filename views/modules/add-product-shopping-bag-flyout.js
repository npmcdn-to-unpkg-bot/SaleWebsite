define(["jquery","ajaxConfig","handlebars","header","configVariables","breakpoints"],function(e,t,n,r,i,s){function d(){e(document).on("shopping-bag.add shopping-bag.remove",e.proxy(v)).on("touchmove",".header-nav-bag-list",function(){clearTimeout(c)}),o.on("mouseenter",function(){clearTimeout(c)})}function v(e,t){l||m(t.data,e)}function m(e,t){g(e.items),e.user=i.user,a.empty();var n=p(e);a.append(n),y(),t.namespace!=="remove"&&b()}function g(e){if(!e)return;var t=0;for(var n=0;n<e.length;n++){var r=e[n];t+=r.quantity}t=t>0?"("+t+")":"",f.html(t)}function y(){var t=e(".header-nav-bag-list",o).children("li").length,n="header-nav-child-bag-empty",r="header-nav-child-bag-small",i="header-nav-child-bag-single",a="header-nav-parent-link-standard",f=e(".header-nav-child-bag",o);f.removeClass(n).removeClass(a).removeClass(i).removeClass(r);switch(t){case 0:f.addClass(n),!s.is("retina")&&s.is("standard")&&u.addClass(a);break;case 1:f.addClass(i),u.removeClass(a);break;case 2:f.addClass(r),u.removeClass(a);break;default:u.removeClass(a)}}function b(){clearTimeout(c),u.trigger("click"),c=setTimeout(function(){r.closeNav(o)},i.times.closeFlyOutWait)}function w(e){g(e.items),e.user=i.user,a.empty();var t=p(e);a.append(t),y()}var o=e("#header-nav-bag-wrapper"),u=e(".header-nav-parent-bag",o),a=e(".header-nav-child-bag-wrapper",o),f=e(".shopping-bag-product-count",o),l=e("#header-main-checkout").length>0,c=null;if(!l)var h=e("#shopping-bag-flyout-template").html(),p=n.compile(h);return{load:function(){d()},refreshMiniCart:w}});
