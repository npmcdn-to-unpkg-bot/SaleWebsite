define(["jquery"],function(e){function f(){var i=n+"-hover",s=".tooltip-close";a.hasClass("no-touch")?a.on("mouseenter",r,m).on("mouseenter",i,l).on("click",n,l).on("click",s,function(){e(r).removeClass(t)}).on("mouseleave",i+", "+r,h):a.hasClass("touch")&&a.on("click touchstart",i,l).on("click touchstart",n,l).on("click touchstart",s,function(){e(r).removeClass(t)})}function l(n){var s=e(this),o=s.attr("href");i=e(r),n.stopPropagation(),p(o);if(n.type==="mouseenter"||n.type==="click")e(o).addClass(t);else if(n.type==="touchstart"){e("html").hasClass("iOS")&&e("html").hasClass("mobile")&&s.closest(".overlay._active").length===0&&e(document.activeElement).blur();if(e(o)&&e(o).parents(".tooltip-wrapper").length>0){var u=e(o).parents(".tooltip-wrapper").offset(),f=u.left>=e(window).width()/2,l=e(window).width()<480,c=e(o).parents(".saved-item-content").length,d=!e(o).css("left")||e(o).css("left")=="0px";l&&c&&d&&f&&e(o).css("left","-85px")}else{var l=e(window).width()<480,g=e(o).hasClass("_active"),y=e("body").hasClass("page-myAccountAddressBookPage");if(l){var b=e(this).offset(),u=e(o).offset();if(y===!0)var w=parseInt(b.left)-250;else var w=parseInt(b.left)-22;var E=-(parseInt(b.left)-25);e(".tooltipStyle")&&e(".tooltipStyle").remove(),e("#page").prepend('<div class="tooltipStyle"><style>.tooltip'+e(o).selector+":after{left:"+w+"px}</style></div>"),y===!0?(e(o).css({left:E+"px",opacity:1,display:"block",visibility:"visible"}),setTimeout(function(){e(o).removeAttr("style"),e(o).removeClass("_active")},2200)):e(o).css({left:E+"px"})}}e(o).toggleClass(t)}else e(o).removeClass(t);m(),e(n.target).is("a")&&v(n),a.hasClass("touch")&&a.on("click touchstart",h)}function c(n){e(n).toggleClass(t)}function h(n){var f=a.hasClass("iOS")?600:275;if(i!==null&&(n.target===i[0]||i.has(n.target).length>0))return;var l=e(this);l.hasClass("tooltip")?(i=l,s=l.parent()):(i=e(r),s=e(r).closest());if(n.type=="touchstart"&&i.hasClass("keep-open-on-touchScroll"))return;u=l.attr("data-autoclose")?e(this).data("autoclose"):!0,!s.is(n.target)&&s.has(n.target).length===0?o=setTimeout(function(){i.removeClass(t)},f):n.type==="mouseleave"&&u===!0&&(o=setTimeout(function(){i.removeClass(t)},f)),a.hasClass("touch")&&a.off("click touchstart",h)}function p(t){var n,r;e(".tooltip._active").each(function(){n=e(this),r="#"+e(this).attr("id"),r!==t&&d(r)})}function d(n){e(n).removeClass(t)}function v(e){e&&e.preventDefault&&e.preventDefault()}function m(){clearTimeout(o)}var t="_active",n=".tooltip-open",r=".tooltip",i=null,s=null,o=null,u=!0,a=e("html");return{load:function(){f()},open:function(e){c(e)},close:function(e){d(e)}}});
