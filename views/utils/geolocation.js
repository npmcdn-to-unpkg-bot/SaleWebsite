define(["googleMaps","dispatcher","cookies"],function(e,t,n){function f(){navigator.geolocation&&(s=!0,l())}function l(){var e=n.get(r);e.isBrowserLocation&&h(a.onUpdate)}function c(){return s}function h(e){c()&&(o?p(e):navigator.geolocation.getCurrentPosition(function(t){d(t,e)},y))}function p(e){t.fireCallbacks(e,u)}function d(t,n){e.getLocationFromLatLng("geolocation",t.coords.latitude+","+t.coords.longitude,function(e){v(e,n)},m)}function v(e,t){e.isBrowserLocation=!0,u=e,n.set(r,u,i),o=!0,p(t)}function m(){g("Sorry, we could not determine your location.")}function g(e){t.fireCallbacks(a.onError,e)}function y(e){e.PERMISSION_DENIED?g("Please give permission if you would like to be geolocated."):g("Sorry, we could not determine your location.")}var r="MM_LOCATION",i=1440,s=!1,o=!1,u={},a={onUpdate:[],onError:[]};return f(),{isSupported:c,get:function(e){h([e])},onUpdate:function(e){a.onUpdate.push(e)},onError:function(e){a.onError.push(e)},unSet:function(){n.unSet(r)}}});
